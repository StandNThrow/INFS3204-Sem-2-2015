<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>NBA League</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="Content/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="Content/Site.css" type="text/css" />
    <script src="Scripts/jquery-2.1.4.min.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <script>
        var uri = "api/player";

        $(document).ready(function (e) {
            $.ajax({
                type: "GET",
                url: uri,
                success: function (response) {
                    console.log(response);
                    displayData(response);
                }
            });
        });

        function formatPlayer(player) {
            return player.RegistrationID + ", " + player.First_Name + " " + player.Last_Name + ", " + player.Team_Name + ", " + player.DOB;
        }

        function displayData(data) {
            $("ul").empty();
            $.each(data, function (key, player) {
                $("<li>", { text: formatPlayer(player) }).appendTo($("#getAllPlayer"));
            });
        }
    </script>
</head>
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">INFS3204 - Prac 4</a>
            </div>
            <div id="navbar" class="nav-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="#">Home</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h3 class="panel-title">All Player</h3>
                    </div>
                    <div class="panel-body">
                        <div id="getAllPlayer"></div>
                    </div>
                </div>
                <div class="row">
                    <form id="formAddPlayer" class="form-line">
                        <div class="col-lg-6">
                            <div class="panel panel-success">
                                <div class="panel-heading">
                                    <h3 class="panel-title">Player Registration</h3>
                                </div>
                                <div class="panel-body">
                                    <div class="form-group">
                                        <label>Registration ID</label>
                                        <input type="text" class="form-control" id="formRegistrationID" name="formRegistrationID" placeholder="Registration ID" />
                                    </div>
                                    <div class="form-group">
                                        <label>First Name</label>
                                        <input type="text" class="form-control" id="formFName" name="formFName" placeholder="First Name" />
                                    </div>
                                    <div class="form-group">
                                        <label>Last Name</label>
                                        <input type="text" class="form-control" id="formLName" name="formLName" placeholder="Last Name" />
                                    </div>
                                    <div class="form-group">
                                        <label>Team Name</label>
                                        <input type="text" class="form-control" id="formTeamName" name="formTeamName" placeholder="Team Name" />
                                    </div>
                                    <div class="form-group">
                                        <label>Date of Birth</label>
                                        <input type="date" class="form-control" id="formDOB" name="formDOB" placeholder="Date of Birth" />
                                    </div>
                                    <div class="form-group">
                                        <input type="button" class="btn btn-success" id="btnAddPlayer" value="Add Player(s)" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <script>
                        $("#btnAddPlayer").click(function (e) {
                            console.log($("#formAddPlayer").serialize());

                            $.ajax({
                                type: "POST",
                                url: uri,
                                data: $("#formAddPlayer").serialize(),
                                success: function (response) {
                                    console.log(response);

                                    $(document).ready(function (e) {
                                        $.ajax({
                                            type: "GET",
                                            url: uri,
                                            success: function (response) {
                                                console.log(response);
                                                displayData(response);
                                            }
                                        });
                                    });
                                },
                                error: function (jqXHR, textStatus, error) {
                                    console.log(jqXHR);
                                }
                            });
                        });
                    </script>
                    <form id="formSearchOrDelete" class="form-inline">
                        <div class="col-lg-6">
                            <div class="panel panel-danger">
                                <div class="panel-heading">
                                    <h3 class="panel-title">Delete Or Search Players</h3>
                                </div>
                                <div class="panel-body">
                                    <div class="col-lg-12">
                                        <div class="form-group">
                                            <select class="form-control" id="selectDropType">
                                                <option value="ID">ID</option>
                                                <option value="Name">Name</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" id="txtSearchOrDelete" name="formSearchOrDelete" placeholder="Keywords" />
                                        </div>
                                        <div class="form-group">
                                            <input type="button" class="btn btn-primary" id="btnSearch" value="Search" />
                                            <input type="button" class="btn btn-danger" id="btnDelete" value="Delete" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <script>
                        $("#btnSearch").click(function (e) {
                            var type = $("#selectDropType").val();
                            var input = $("#txtSearchOrDelete").val();
                            //console.log("Type: " + type + ", " + "Input: " + input);

                            $.ajax({
                                type: "GET",
                                url: uri + "/" + type + "/" + input,
                                data: $("#formSearchOrDelete").serialize(),
                                success: function (response) {
                                    console.log(response);
                                    $("#getAllPlayer").empty();
                                    displayData(response);
                                },
                                error: function (jqXHR, textStatus, error) {
                                    $("#getAllPlayer").html("No results found for: <i>" + input + "</i>.");
                                    console.log(error);
                                }
                            });
                        });

                        $("#btnDelete").click(function (e) {
                            var type = $("#selectDropType").val();
                            var input = $("#txtSearchOrDelete").val();
                            //console.log("Type: " + type + ", " + "Input: " + input);

                            $.ajax({
                                type: "DELETE",
                                url: uri + "/" + type + "/" + input,
                                data: $("#formSearchOrDelete").serialize(),
                                success: function (response) {
                                    console.log(response);
                                    $("#getAllPlayer").empty();
                                    displayData(response);
                                },
                                error: function (jqXHR, textStatus, error) {
                                    $("#getAllPlayer").empty();
                                    $("#getAllPlayer").html("Your input: <i>" + input + "</i> for Type: <i>" + type + "</i> is " + error + ", and therefore not deleted.");
                                    console.log(error);
                                }
                            });
                        });
                    </script>
                    <!--<div class="col-lg-4">
                        <div class="panel panel-primary">
                            <div class="panel-heading">
                                <h3 class="panel-title">Search Books</h3>
                            </div>
                            <div class="panel-body">
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <asp:DropDownList ID="dropSearch" runat="server" CssClass="form-control"></asp:DropDownList>
                                    </div>
                                    <div class="form-group">
                                        <asp:TextBox ID="txtSearch" runat="server" CssClass="form-control" placeholder="Search"></asp:TextBox>
                                    </div>
                                    <div class="form-group">
                                        <asp:Button type="button" ID="btnSearchBooks" runat="server" CssClass="btn btn-primary" OnClick="btnSearchBooks_Click" Text="Search Book(s)" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>-->
                    <!--<div class="col-lg-8">
                        <div class="panel panel-warning">
                            <div class="panel panel-heading">
                                <h3 class="panel-title">Purchase Book</h3>
                            </div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <asp:Label ID="lblTotalBudget" runat="server" Text="Total Budget: "></asp:Label>
                                    <asp:TextBox ID="txtTotalBudget" runat="server" CssClass="form-control" placeholder="Enter your budget here"></asp:TextBox>
                                </div>
                                <asp:Label ID="lblBookNumber_0" runat="server" Text="Book No: "></asp:Label>
                                <asp:TextBox ID="txtBookNumber_0" runat="server"></asp:TextBox>

                                <asp:Label ID="lblQty_0" runat="server" Text="Qty: "></asp:Label>
                                <asp:TextBox ID="txtQty_0" runat="server"></asp:TextBox>
                                <p />
                                <asp:PlaceHolder ID="placeHolderAddField" runat="server"></asp:PlaceHolder>
                                <div class="form-group">
                                    <asp:Button ID="btnMore" runat="server" CssClass="btn btn-warning" OnClick="btnMore_Click" Text="Add Field(s)" />
                                </div>
                                <p />
                                <div class="form-group">
                                    <asp:TextBox ID="txtPurchase" runat="server" CssClass="form-control" placeholder="Your result will be shown here"></asp:TextBox>
                                </div>
                                <div class="form-group">
                                    <asp:Button ID="btnPurchase" runat="server" CssClass="btn btn-warning" OnClick="btnPurchase_Click" Text="Purchase Book(s)" />
                                </div>
                            </div>
                        </div>
                    </div>-->
                </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>